#! /bin/sh
patch -p1 -l -f $* < $0
exit $?

From 10fd35c85eaa44bf573380ad84acf620e073f088 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Ingo=20Kl=C3=B6cker?= <dev@ingo-kloecker.de>
Date: Thu, 8 Dec 2022 15:37:54 +0100
Subject: [PATCH 1/4] Don't report success if the key signing job was canceled

GnuPG-bug-id: 6305
---
 src/commands/certifycertificatecommand.cpp | 18 ++++++++++--------
 1 file changed, 10 insertions(+), 8 deletions(-)

diff --git a/src/commands/certifycertificatecommand.cpp b/src/commands/certifycertificatecommand.cpp
index 212a3288..5dab5eb5 100644
--- a/src/commands/certifycertificatecommand.cpp
+++ b/src/commands/certifycertificatecommand.cpp
@@ -229,23 +229,25 @@ void CertifyCertificateCommand::Private::slotDialogRejected()

 void CertifyCertificateCommand::Private::slotResult(const Error &err)
 {
-    if (!err && !err.isCanceled() && dialog && dialog->exportableCertificationSelected() && dialog->sendToServer()) {
-        auto const cmd = new ExportOpenPGPCertsToServerCommand(target);
-        cmd->start();
-    } else if (!err) {
-        information(i18n("Certification successful."),
-                    i18n("Certification Succeeded"));
-    } else {
+    if (err.isCanceled()) {
+        // do nothing
+    } else if (err) {
         error(i18n("<p>An error occurred while trying to certify<br/><br/>"
                    "<b>%1</b>:</p><p>\t%2</p>",
               Formatting::formatForComboBox(target),
               QString::fromUtf8(err.asString())),
               i18n("Certification Error"));
+    } else if (dialog && dialog->exportableCertificationSelected() && dialog->sendToServer()) {
+        auto const cmd = new ExportOpenPGPCertsToServerCommand(target);
+        cmd->start();
+    } else {
+        information(i18n("Certification successful."),
+                    i18n("Certification Succeeded"));
     }
+
     if (!dialog->tags().isEmpty()) {
         Tags::enableTags();
     }
-
     finished();
 }

--
2.38.1
